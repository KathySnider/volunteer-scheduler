# Volunteer Scheduler

A full-stack web prototype for managing organizational events, volunteer opportunities, and shift assignments. Built with Next.js (React) frontend and Go GraphQL backend.

## Overview

This application will allow organizations to:
- Create and manage events with which volunteers can help.
- Define volunteer opportunities(with specific roles (and required qualifications, if any).
- Schedule shifts for each opportunity.
- Match volunteers with appropriate shifts (based on their qualifications if appropriate).
- Track volunteer assignments and availability.

Currently, this is only a prototype to see how the volunteers like the signup features, so data  (events, volunteer information, etc.) has to be entered thru psql. 
More features coming all the time.

## Architecture

### Frontend (`vol_sched_app/`)
- **Framework**: Next.js 16 (React 19)
- **Styling**: Tailwind CSS
- **Icons**: Lucide React
- **API Client**: GraphQL queries to backend

### Backend (`vol_sched_api/`)
- **Language**: Go
- **API**: GraphQL (using gqlgen)
- **Database**: PostgreSQL
- **ORM**: Standard library `database/sql`

### Database
- **Type**: PostgreSQL
- **Migrations**: golang-migrate
- **Schema**: Fully normalized (3NF)

## Prerequisites
- **Node.js** 18+ and npm
- **Go** 1.25+
- **PostgreSQL** 14+
- **golang-migrate** (for database migrations)

## Project Structure

```
volunteer-scheduler/
├── vol_sched_api/              # Go GraphQL backend
│   ├── server.go               # Main server entry point
│   ├── schema.graphql          # GraphQL schema definition
│   ├── gqlgen.yml              # gqlgen configuration
│   ├── go.mod                  # Go dependencies
│   ├── graph/                  # Generated GraphQL code
│   │   ├── resolver.go         # Main resolver
│   │   ├── schema.resolvers.go # Query/mutation implementations
│   │   ├── generated.go        # Auto-generated by gqlgen
│   │   └── model/              # GraphQL models
│   └── models/                 # Custom models (if any)
│
├── vol_sched_app/              # Next.js React frontend
│   ├── src/
│   │   └── app/
│   │       ├── components/     # React components
│   │       │   ├── VolunteerEventsApp.jsx    # Main events listing
│   │       │   └── EventDetailPage.jsx       # Event detail page
│   │       ├── event/[id]/     # Dynamic route for event details
│   │       │   └── page.js
│   │       ├── page.js         # Home page
│   │       └── globals.css     # Global styles
│   ├── package.json
│   ├── next.config.mjs
│   └── tailwind.config.js
│
├── database/
│   ├── migrations/             # Database migration files
│   │   ├── 000001_initial_schema.up.sql
│   │   └── 000001_initial_schema.down.sql
│   ├── sample-data/           # Sample CSV data files
│   └── README.md              # Database setup instructions
│
├── LICENSE
└── README.md                   # This file
```


## Getting Started

### 1. Clone the repo

```bash
git clone https://github.com/YOUR_USERNAME/volunteer-scheduler.git
cd volunteer-scheduler
```

### 2. Set environment variables

#### Backend (vol_sched_api)

Create a `.env` file in the `vol_sched_api/` directory (suggested):

```env
DATABASE_URL=postgres://postgres:YOUR_PASSWORD@localhost:5432/volunteer_scheduler?sslmode=disable
PORT=8080
```

Or set them in your shell:

```bash
export DATABASE_URL="postgres://postgres:YOUR_PASSWORD@localhost:5432/volunteer_scheduler?sslmode=disable"
export PORT=8080
```

#### Frontend (vol_sched_app)

No environment variables required for local development. The app is configured to connect to `http://localhost:8080/query` by default.

For production, you may want to set:

```env
NEXT_PUBLIC_API_URL=https://your-api-domain.com/query
```

### 3. Set up the database

#### Install golang-migrate

```bash
go install -tags 'postgres' github.com/golang-migrate/migrate/v4/cmd/migrate@latest
```

#### Create PostgreSQL DB

```bash
psql -U postgres
CREATE DATABASE volunteer_scheduler;
\q
```

#### Run migrations

```bash
migrate -database $DATABASE_URL -path database/migrations up
```

#### (Optional) Load sample data

Sample CSV files are available in `database/sample-data/`. Import in the order shown as the database
enforces rules about things already existing before they are referenced.

```bash
psql -U postgres -d volunteer_scheduler

\copy locations FROM 'database/sample-data/01-locations.csv' CSV HEADER;
\copy events FROM 'database/sample-data/02-events.csv' CSV HEADER;
\copy event_dates FROM 'database/sample-data/03-event_dates.csv' CSV HEADER;
\copy volunteers FROM 'database/sample-data/04-volunteers.csv' CSV HEADER;
\copy volunteer_qualifications FROM 'database/sample-data/05-volunteer_qualifications.csv' CSV HEADER;
\copy volunteer_preferences FROM 'database/sample-data/06-volunteer_preferences.csv' CSV HEADER;
\copy staff FROM 'database/sample-data/07-staff.csv' CSV HEADER;
\copy opportunities FROM 'database/sample-data/08-opportunities.csv' CSV HEADER;
\copy opportunity_requirements FROM 'database/sample-data/09-opportunity_requirements.csv' CSV HEADER;
\copy shifts FROM 'database/sample-data/10-shifts.csv' CSV HEADER;
\copy volunteer_shifts FROM 'database/sample-data/11-volunteer_shifts.csv' CSV HEADER;
\copy event_attendees FROM 'database/sample-data/12-event_attendees.csv' CSV HEADER;

\q
```

### 4. Set up and run the server (vol_sched_api)

```bash
cd vol_sched_api

# Install Go dependencies
go mod download

# Run the server
go run server.go
```

The GraphQL API will be available to try out at:
- **API Endpoint**: http://localhost:8080/query
- **GraphQL Playground**: http://localhost:8080/

### 4. Set up the frontend

```bash
cd vol_sched_app

# Install dependencies
npm install

# Run the development server
npm run dev
```

The web application will be available at http://localhost:3000


## Features

### Events Listing Page
- Filter events by:
  - City (multi-select)
  - Event type (Virtual, In-Person, Hybrid)
  - Volunteer roles needed
  - Date range
- View events with key information.
- Navigate to event details using the "More Info" button.

### Event Detail Page
- View complete event information.
- See all volunteer opportunities and shifts.
- Assign volunteers to shifts.
- Autocomplete volunteer search with qualification filtering.
- View currently assigned volunteers.
- Track shift capacity (assigned vs. max volunteers).

### GraphQL API
- Query events with flexible filtering.
- Query volunteers by qualifications.
- Mutations for assigning volunteers to shifts.
- Fully typed schema with enums for roles and qualifications.

## Database Schema

The database is normalized to Third Normal Form (3NF) with the following main entities:

- **Events**: An organization's events that will need volunteers, with dates and locations.
- **Locations**: Reusable venue information.
- **Opportunities**: Volunteer roles within events.
- **Shifts**: Time slots for opportunities.
- **Volunteers**: Registered volunteers (with qualifications if appropriate).
- **Staff**: Staff member to contacts for a shift.
- **Assignments**: Junction table linking volunteers to shifts.


## Development and customization

### Regenerate GraphQL Code (Backend)

After customizing `schema.graphql`:

```bash
cd vol_sched_api
gqlgen generate
```

### Database Migrations

#### Create a new migration:

```bash
migrate create -ext sql -dir database/migrations -seq migration_name
```

#### Apply migrations:

```bash
migrate -database $DATABASE_URL -path database/migrations up
```

#### Rollback last migration:

```bash
migrate -database $DATABASE_URL -path database/migrations down 1
```

### Frontend Development

The frontend uses:
- **React hooks** for state management.
- **Next.js App Router** for routing.
- **Tailwind CSS** for styling.
- **Client-side rendering** (all components use `'use client'`).

## API Documentation

### GraphQL Playground

Visit http://localhost:8080/ when the server is running to access the interactive GraphQL Playground where you can:
- Explore the schema.
- Test queries and mutations.

### Example Queries

#### Get all events in a city:

```graphql
query {
  events(filter: { cities: ["Austin"] }) {
    id
    name
    description
    eventType
    location {
      city
      state
    }
  }
}
```

#### Get event details with volunteer opportunities:

```graphql
query {
  event(id: "1") {
    name
    description
    opportunities {
      role
      shifts {
        date
        startTime
        endTime
        assignedVolunteers {
          firstName
          lastName
        }
      }
    }
  }
}
```

#### Assign a volunteer to a shift:

```graphql
mutation {
  assignVolunteerToShift(shiftId: "5", volunteerId: "3") {
    success
    message
  }
}
```

## Testing

### Backend (coming)
```bash
cd vol_sched_api
go test ./...
```

### Frontend (coming)
```bash
cd vol_sched_app
npm test
```

## Deployment

### Backend Deployment

1. Build the Go binary:
```bash
cd vol_sched_api
go build -o volunteer-api server.go
```

2. Run migrations on production database
3. Set `DATABASE_URL` environment variable
4. Run the binary: `./volunteer-api`

### Frontend Deployment

1. Build the Next.js app:
```bash
cd vol_sched_app
npm run build
```

2. Deploy to Vercel, Netlify, or your preferred hosting:
```bash
npm run start
```

Or use the Vercel CLI:
```bash
vercel deploy
```

## Contributing

1. Fork the repository
2. Create a feature branch: `git checkout -b feature-name`
3. Commit changes: `git commit -am 'Add feature'`
4. Push to branch: `git push origin feature-name`
5. Submit a pull request

## License

MIT License


## Acknowledgments

- Built with [gqlgen](https://gqlgen.com/) for GraphQL in Go
- UI components styled with [Tailwind CSS](https://tailwindcss.com/)
- Icons from [Lucide React](https://lucide.dev/)
- Database migrations managed by [golang-migrate](https://github.com/golang-migrate/migrate)